<mxfile host="app.diagrams.net">
    <diagram id="arch" name="Architecture">
        <mxGraphModel dx="1600" dy="900" grid="1">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>

                <!-- Top Layer: Config + Eureka -->
                <mxCell id="cfg" value="Config Server" style="rounded=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1">
                    <mxGeometry x="400" y="20" width="180" height="60" as="geometry"/>
                </mxCell>

                <mxCell id="eureka" value="Eureka Server" style="rounded=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1">
                    <mxGeometry x="650" y="20" width="180" height="60" as="geometry"/>
                </mxCell>

                <!-- API Gateway Layer -->
                <mxCell id="gateway" value="API Gateway" style="rounded=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=16;" vertex="1">
                    <mxGeometry x="530" y="120" width="200" height="70" as="geometry"/>
                </mxCell>

                <!-- Business Services Layer -->
                <mxCell id="services" value="Business Services" style="swimlane;fontStyle=1;horizontal=0;" vertex="1">
                    <mxGeometry x="200" y="250" width="900" height="330" as="geometry"/>
                </mxCell>

                <mxCell id="auth" value="Auth Service" style="rounded=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="services">
                    <mxGeometry x="20" y="40" width="160" height="60" as="geometry"/>
                </mxCell>

                <mxCell id="user" value="User Service" style="rounded=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="services">
                    <mxGeometry x="200" y="40" width="160" height="60" as="geometry"/>
                </mxCell>

                <mxCell id="category" value="Category Service" style="rounded=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="services">
                    <mxGeometry x="380" y="40" width="160" height="60" as="geometry"/>
                </mxCell>

                <mxCell id="job" value="Job Service (Kafka Producer)" style="rounded=1;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1;" vertex="1" parent="services">
                    <mxGeometry x="560" y="40" width="200" height="60" as="geometry"/>
                </mxCell>

                <mxCell id="advert" value="Advert Service" style="rounded=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="services">
                    <mxGeometry x="20" y="140" width="160" height="60" as="geometry"/>
                </mxCell>

                <mxCell id="offer" value="Offer Service" style="rounded=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="services">
                    <mxGeometry x="200" y="140" width="160" height="60" as="geometry"/>
                </mxCell>

                <mxCell id="file" value="File Storage Service" style="rounded=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="services">
                    <mxGeometry x="380" y="140" width="200" height="60" as="geometry"/>
                </mxCell>

                <mxCell id="notif" value="Notification Service (Kafka Consumer)" style="rounded=1;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1;" vertex="1" parent="services">
                    <mxGeometry x="620" y="140" width="240" height="60" as="geometry"/>
                </mxCell>

                <!-- Messaging Layer -->
                <mxCell id="kafka" value="Kafka Broker" style="rounded=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=16;" vertex="1">
                    <mxGeometry x="500" y="610" width="220" height="70" as="geometry"/>
                </mxCell>

                <mxCell id="zk" value="Zookeeper" style="rounded=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1">
                    <mxGeometry x="760" y="610" width="180" height="70" as="geometry"/>
                </mxCell>

                <!-- Persistence Layer -->
                <mxCell id="db" value="PostgreSQL Database" style="rounded=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=16;" vertex="1">
                    <mxGeometry x="500" y="730" width="260" height="80" as="geometry"/>
                </mxCell>

                <!-- REST Arrows -->
                <mxCell id="a1" edge="1" source="gateway" target="auth" style="endArrow=block;strokeColor=#000000;"/>
                <mxCell id="a2" edge="1" source="gateway" target="user" style="endArrow=block;strokeColor=#000000;"/>
                <mxCell id="a3" edge="1" source="gateway" target="category" style="endArrow=block;strokeColor=#000000;"/>
                <mxCell id="a4" edge="1" source="gateway" target="job" style="endArrow=block;strokeColor=#000000;"/>
                <mxCell id="a5" edge="1" source="gateway" target="advert" style="endArrow=block;strokeColor=#000000;"/>
                <mxCell id="a6" edge="1" source="gateway" target="offer" style="endArrow=block;strokeColor=#000000;"/>
                <mxCell id="a7" edge="1" source="gateway" target="file" style="endArrow=block;strokeColor=#000000;"/>
                <mxCell id="a8" edge="1" source="gateway" target="notif" style="endArrow=block;strokeColor=#000000;"/>

                <!-- Kafka Arrows -->
                <mxCell id="k1" edge="1" source="job" target="kafka" style="strokeColor=#b85450;endArrow=block;"/>
                <mxCell id="k2" edge="1" source="kafka" target="notif" style="strokeColor=#b85450;endArrow=block;"/>

                <!-- Database Arrows -->
                <mxCell id="db1" edge="1" source="auth" target="db" style="dashed=1;endArrow=block;strokeColor=#9673a6;"/>
                <mxCell id="db2" edge="1" source="user" target="db" style="dashed=1;endArrow=block;strokeColor=#9673a6;"/>
                <mxCell id="db3" edge="1" source="category" target="db" style="dashed=1;endArrow=block;strokeColor=#9673a6;"/>
                <mxCell id="db4" edge="1" source="job" target="db" style="dashed=1;endArrow=block;strokeColor=#9673a6;"/>
                <mxCell id="db5" edge="1" source="advert" target="db" style="dashed=1;endArrow=block;strokeColor=#9673a6;"/>
                <mxCell id="db6" edge="1" source="offer" target="db" style="dashed=1;endArrow=block;strokeColor=#9673a6;"/>
                <mxCell id="db7" edge="1" source="file" target="db" style="dashed=1;endArrow=block;strokeColor=#9673a6;"/>

                <!-- Config + Eureka -->
                <mxCell id="c1" edge="1" source="cfg" target="auth" style="dashed=1;strokeColor=#6c8ebf;endArrow=block;"/>
                <mxCell id="c2" edge="1" source="cfg" target="job" style="dashed=1;strokeColor=#6c8ebf;endArrow=block;"/>
                <mxCell id="c3" edge="1" source="eureka" target="auth" style="dashed=1;strokeColor=#d79b00;endArrow=block;"/>
                <mxCell id="c4" edge="1" source="eureka" target="job" style="dashed=1;strokeColor=#d79b00;endArrow=block;"/>

            </root>
        </mxGraphModel>
    </diagram>
</mxfile>
